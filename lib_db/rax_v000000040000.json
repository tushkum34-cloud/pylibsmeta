{
  "__all__": [],
  "__version__": [],
  "Array": [],
  "LambdaweightFn": [],
  "ReduceFn": [],
  "softmax_loss": [
    "scores",
    "labels"
  ],
  "poly1_softmax_loss": [
    "scores",
    "labels"
  ],
  "unique_softmax_loss": [
    "scores",
    "labels"
  ],
  "listmle_loss": [
    "scores",
    "labels"
  ],
  "pairwise_loss": [
    "scores",
    "labels"
  ],
  "pairwise_hinge_loss": [
    "scores",
    "labels"
  ],
  "pairwise_logistic_loss": [
    "scores",
    "labels"
  ],
  "pairwise_soft_zero_one_loss": [
    "scores",
    "labels"
  ],
  "pointwise_sigmoid_loss": [
    "scores",
    "labels"
  ],
  "pointwise_mse_loss": [
    "scores",
    "labels"
  ],
  "pairwise_mse_loss": [
    "scores",
    "labels"
  ],
  "pairwise_qr_loss": [
    "scores",
    "labels"
  ],
  "ApproxT12nTest": {
    "test_approx_t12n_metric_has_nonzero_nonnan_loss": [
      "self",
      "metric_fn"
    ],
    "test_approx_t12n_metric_has_nonzero_nonnan_grads": [
      "self",
      "metric_fn"
    ],
    "test_approx_t12n_metric_has_nonnan_grads_with_all_where": [
      "self",
      "metric_fn"
    ],
    "test_approx_t12n_metric_has_nonnan_grads_with_zero_labels": [
      "self",
      "metric_fn"
    ]
  },
  "BoundT12nTest": {
    "test_computes_upper_bound_on_ranks": [
      "self"
    ],
    "test_computes_lower_bound_on_cutoffs": [
      "self"
    ],
    "test_bound_t12n_metric_has_nonzero_nonnan_loss": [
      "self",
      "metric_fn"
    ],
    "test_bound_t12n_metric_has_nonzero_nonnan_grads": [
      "self",
      "metric_fn"
    ],
    "test_bound_t12n_metric_has_nonnan_grads_with_all_where": [
      "self",
      "metric_fn"
    ],
    "test_bound_t12n_metric_has_nonnan_grads_with_zero_labels": [
      "self",
      "metric_fn"
    ]
  },
  "GumbelT12nTest": {
    "test_samples_scores_using_key": [
      "self"
    ],
    "test_repeats_inputs_n_times": [
      "self"
    ],
    "test_samples_scores_using_gumbel_beta_shape": [
      "self"
    ],
    "test_handles_extreme_scores": [
      "self"
    ],
    "test_raises_an_error_if_no_key_is_provided": [
      "self"
    ],
    "test_applies_log_softmax_transformation": [
      "self"
    ],
    "test_smoothing_factor_should_handle_extreme_values": [
      "self"
    ],
    "test_returns_function_with_key_in_signature": [
      "self"
    ]
  },
  "SegmentT12nTest": {
    "test_computes_fn_on_segments": [
      "self",
      "fn"
    ],
    "test_computes_fn_on_segments_with_batch_dims": [
      "self",
      "fn"
    ],
    "test_computes_fn_on_non_consecutive_segments": [
      "self",
      "fn"
    ],
    "test_computes_fn_with_mask": [
      "self",
      "fn"
    ],
    "test_computes_fn_with_weights": [
      "self",
      "fn"
    ],
    "test_computes_fn_with_random_key": [
      "self",
      "fn"
    ],
    "test_uses_segmented_implementation_when_available": [
      "self"
    ],
    "test_uses_mask_when_not_none": [
      "self"
    ],
    "test_returns_function_with_segments_in_signature": [
      "self"
    ]
  },
  "load_tests": [
    "loader",
    "tests",
    "ignore"
  ],
  "SameSegmentMaskTest": {
    "test_returns_pairwise_mask_indicating_same_segments": [
      "self"
    ]
  },
  "SegmentSumTest": {
    "test_segment_sum": [
      "self"
    ],
    "test_handles_nan": [
      "self"
    ]
  },
  "SegmentMaxTest": {
    "test_computes_max_per_segment": [
      "self"
    ],
    "test_handles_nan": [
      "self"
    ],
    "test_computes_max_with_initial_value": [
      "self"
    ],
    "test_computes_max_with_mask": [
      "self"
    ]
  },
  "SegmentLogSoftmaxTest": {
    "test_computes_log_softmax": [
      "self"
    ],
    "test_computes_log_softmax_with_mask": [
      "self"
    ],
    "test_handles_extreme_values": [
      "self"
    ]
  },
  "SegmentSoftmaxTest": {
    "test_computes_softmax": [
      "self"
    ],
    "test_computes_softmax_with_mask": [
      "self"
    ],
    "test_handles_extreme_values": [
      "self"
    ]
  },
  "InSegmentIndicesTest": {
    "test_in_segment_indices": [
      "self"
    ],
    "test_in_segment_indices_unordered": [
      "self"
    ]
  },
  "FirstItemSegmentMask": {
    "test_selects_first_item_per_segment": [
      "self"
    ],
    "test_does_not_select_masked_items": [
      "self"
    ]
  },
  "SegmentLogcumsumexpTest": {
    "test_computes_logcumsumexp": [
      "self"
    ],
    "test_computes_over_specified_axis": [
      "self"
    ],
    "test_computes_reversed": [
      "self"
    ],
    "test_computes_with_where_mask": [
      "self"
    ],
    "test_handles_extreme_values": [
      "self"
    ]
  },
  "CutoffFn": [],
  "RankFn": [],
  "_retrieved_items": [
    "scores",
    "ranks"
  ],
  "default_gain_fn": [
    "label"
  ],
  "default_discount_fn": [
    "rank"
  ],
  "mrr_metric": [
    "scores",
    "labels"
  ],
  "recall_metric": [
    "scores",
    "labels"
  ],
  "precision_metric": [
    "scores",
    "labels"
  ],
  "ap_metric": [
    "scores",
    "labels"
  ],
  "opa_metric": [
    "scores",
    "labels"
  ],
  "dcg_metric": [
    "scores",
    "labels"
  ],
  "ndcg_metric": [
    "scores",
    "labels"
  ],
  "discount": [],
  "gain": [],
  "LambdaweightsTest": {
    "test_computes_lambdaweights": [
      "self",
      "lambdaweight_fn",
      "expected"
    ],
    "test_computes_normalized_lambdaweights": [
      "self",
      "lambdaweight_fn",
      "normalizer"
    ],
    "test_lambdaweights_with_batchdim": [
      "self",
      "lambdaweight_fn",
      "expected"
    ],
    "test_lambdaweights_with_segments": [
      "self",
      "lambdaweight_fn"
    ],
    "test_lambdaweights_with_empty_list": [
      "self",
      "lambdaweight_fn"
    ],
    "test_lambdaweights_with_where_mask": [
      "self",
      "lambdaweight_fn",
      "expected"
    ],
    "test_lambdaweights_with_weights": [
      "self",
      "lambdaweight_fn",
      "expected"
    ],
    "test_lambdaweights_with_topn": [
      "self",
      "lambdaweight_fn",
      "expected"
    ],
    "test_computes_with_pairwise_loss": [
      "self",
      "loss_fn",
      "lambdaweight_fn",
      "expected"
    ]
  },
  "labeldiff_lambdaweight": [
    "scores",
    "labels"
  ],
  "_generic_dcg_lambdaweight": [
    "scores",
    "labels",
    "rank_pair_discount_fn"
  ],
  "dcg_lambdaweight": [
    "scores",
    "labels"
  ],
  "dcg2_lambdaweight": [
    "scores",
    "labels"
  ],
  "T": [],
  "safe_reduce": [
    "a",
    "where",
    "reduce_fn"
  ],
  "normalize_probabilities": [
    "unscaled_probabilities"
  ],
  "logcumsumexp": [
    "x"
  ],
  "sort_by": [
    "scores",
    "tensors_to_sort",
    "axis",
    "where",
    "segments",
    "key"
  ],
  "ranks": [
    "scores"
  ],
  "approx_ranks": [
    "scores"
  ],
  "cutoff": [
    "a",
    "n",
    "where",
    "segments"
  ],
  "approx_cutoff": [
    "a",
    "n"
  ],
  "compute_pairs": [
    "a",
    "op"
  ],
  "update_signature": [
    "wrapped"
  ],
  "NormalizeProbabilitiesTest": {
    "test_sums_to_one_for_given_axis": [
      "self"
    ],
    "test_sums_to_one_for_default_axis": [
      "self"
    ],
    "test_handles_where": [
      "self"
    ],
    "test_handles_segments": [
      "self"
    ],
    "test_handles_where_and_segments_with_any_axis": [
      "self"
    ],
    "test_correctly_sets_all_zeros": [
      "self"
    ],
    "test_correctly_handles_all_masked": [
      "self"
    ]
  },
  "LogCumsumExp": {
    "test_computes_logcumsumexp": [
      "self"
    ],
    "test_computes_over_specified_axis": [
      "self"
    ],
    "test_computes_reversed": [
      "self"
    ],
    "test_computes_with_where_mask": [
      "self"
    ],
    "test_handles_extreme_values": [
      "self"
    ]
  },
  "SortByTest": {
    "test_sorts_by_scores": [
      "self"
    ],
    "test_sorts_by_given_axis": [
      "self"
    ],
    "test_sorts_multiple_tensors": [
      "self"
    ],
    "test_places_masked_values_last": [
      "self"
    ],
    "test_breaks_ties_randomly_when_key_is_provided": [
      "self"
    ],
    "test_sorts_within_segments": [
      "self"
    ],
    "test_places_masked_values_last_in_each_segment": [
      "self"
    ]
  },
  "CutoffTest": {
    "test_cutoff": [
      "self"
    ],
    "test_cutoff_with_where": [
      "self"
    ],
    "test_cutoff_with_segments": [
      "self"
    ],
    "test_cutoff_with_segments_and_where": [
      "self"
    ],
    "test_cutoff_no_n": [
      "self"
    ],
    "test_cutoff_large_n": [
      "self"
    ],
    "test_cutoff_n_is_zero": [
      "self"
    ]
  },
  "ApproxCutoffTest": {
    "test_approx_cutoff": [
      "self"
    ],
    "test_approx_cutoff_hard": [
      "self"
    ],
    "test_approx_cutoff_with_where": [
      "self"
    ],
    "test_approx_cutoff_with_segments": [
      "self"
    ],
    "test_approx_cutoff_with_segments_and_where": [
      "self"
    ],
    "test_approx_cutoff_no_n": [
      "self"
    ],
    "test_approx_cutoff_large_n": [
      "self"
    ],
    "test_approx_cutoff_n_is_zero": [
      "self"
    ]
  },
  "RanksTest": {
    "test_ranks_by_sorting_scores": [
      "self"
    ],
    "test_ranks_along_given_axis": [
      "self"
    ],
    "test_ranks_with_ties_broken_randomly": [
      "self"
    ],
    "test_ranks_with_segments": [
      "self"
    ],
    "test_ranks_with_segments_and_where": [
      "self"
    ]
  },
  "ApproxRanksTest": {
    "test_computes_approx_ranks": [
      "self"
    ],
    "test_maintains_order": [
      "self"
    ],
    "test_computes_approx_ranks_with_where": [
      "self"
    ],
    "test_computes_approx_ranks_with_segments": [
      "self"
    ]
  },
  "SafeReduceTest": {
    "test_reduces_values_according_to_fn": [
      "self"
    ],
    "test_reduces_values_with_mask": [
      "self"
    ],
    "test_reduces_mean_with_all_masked": [
      "self"
    ]
  },
  "ComputePairsTest": {
    "test_computes_all_pairs": [
      "self"
    ],
    "test_computes_all_pairs_on_empty_array": [
      "self"
    ],
    "test_computes_all_pairs_with_batch_dimension": [
      "self"
    ]
  },
  "UpdateSignatureTest": {
    "test_adds_parameter_to_wrapped_fn": [
      "self"
    ],
    "test_adds_parameter_to_wrapped_fn_2": [
      "self"
    ],
    "test_does_not_add_parameters_that_already_exist": [
      "self"
    ],
    "test_adds_multiple_parameters": [
      "self"
    ],
    "test_keeps_signature_when_extra_parameters_is_empty": [
      "self"
    ]
  },
  "same_segment_mask": [
    "segments"
  ],
  "segment_sum": [
    "a",
    "segments",
    "where"
  ],
  "segment_max": [
    "a",
    "segments",
    "where",
    "initial"
  ],
  "segment_log_softmax": [
    "a",
    "segments",
    "where"
  ],
  "segment_softmax": [
    "a",
    "segments",
    "where"
  ],
  "in_segment_indices": [
    "segments"
  ],
  "first_item_segment_mask": [
    "segments",
    "where"
  ],
  "segment_logcumsumexp": [
    "x",
    "segments"
  ],
  "LossFn": {
    "__call__": [
      "self",
      "scores",
      "labels"
    ]
  },
  "MetricFn": {
    "__call__": [
      "self",
      "scores",
      "labels"
    ]
  },
  "LossOrMetricFn": [],
  "_accepts_args": [
    "fn"
  ],
  "approx_t12n": [
    "metric_fn",
    "temperature"
  ],
  "bound_t12n": [
    "metric_fn"
  ],
  "gumbel_t12n": [
    "loss_or_metric_fn"
  ],
  "segment_t12n": [
    "loss_or_metric_fn"
  ],
  "log2": [],
  "MetricsTest": {
    "test_computes_metric_value": [
      "self",
      "metric_fn",
      "expected_value"
    ],
    "test_computes_metric_value_on_batch_with_vmap": [
      "self",
      "metric_fn",
      "expected_value"
    ],
    "test_computes_reduced_metric": [
      "self",
      "metric_fn",
      "expected_value",
      "normalizer"
    ],
    "test_computes_unreduced_metric": [
      "self",
      "metric_fn",
      "expected_shape"
    ],
    "test_computes_weighted_metric": [
      "self",
      "metric_fn",
      "expected_value"
    ],
    "test_computes_metric_with_topn_1": [
      "self",
      "metric_fn",
      "expected_value"
    ],
    "test_computes_metric_with_topn_3": [
      "self",
      "metric_fn",
      "expected_value"
    ],
    "test_computes_metric_value_with_all_masked": [
      "self",
      "metric_fn",
      "expected_value"
    ],
    "test_computes_metric_value_with_no_relevant_labels": [
      "self",
      "metric_fn",
      "expected_value"
    ],
    "test_treats_neginf_as_unranked_items": [
      "self",
      "metric_fn",
      "expected_value"
    ],
    "test_ignores_lists_containing_only_invalid_items": [
      "self",
      "metric_fn"
    ],
    "test_computes_metric_with_segments": [
      "self",
      "metric_fn"
    ],
    "test_computes_metric_with_segments_and_mask": [
      "self",
      "metric_fn"
    ],
    "test_computes_metric_with_segments_and_batch_dim": [
      "self",
      "metric_fn"
    ],
    "test_computes_metric_with_segments_and_cutoff": [
      "self",
      "metric_fn"
    ]
  },
  "RetrievedItemsTest": {
    "test_does_not_retrieve_items_with_neginf_scores": [
      "self"
    ],
    "test_does_not_retrieve_masked_items": [
      "self"
    ],
    "test_does_not_retrieve_items_beyond_topn": [
      "self",
      "topn",
      "expected"
    ]
  },
  "exp": [],
  "log": [],
  "logloss": [],
  "sigmoid": [],
  "LossesTest": {
    "test_computes_loss_value": [
      "self",
      "loss_fn",
      "expected_value"
    ],
    "test_computes_loss_with_extreme_inputs": [
      "self",
      "loss_fn",
      "expected_value"
    ],
    "test_computes_loss_for_zero_labels": [
      "self",
      "loss_fn",
      "expected_value"
    ],
    "test_computes_weighted_loss_value": [
      "self",
      "loss_fn",
      "expected_value"
    ],
    "test_computes_loss_value_with_vmap": [
      "self",
      "loss_fn",
      "expected_value"
    ],
    "test_computes_reduced_loss": [
      "self",
      "loss_fn",
      "expected_value",
      "normalizer"
    ],
    "test_computes_unreduced_loss": [
      "self",
      "loss_fn",
      "expected_shape"
    ],
    "test_computes_loss_value_with_segments": [
      "self",
      "loss_fn"
    ],
    "test_computes_loss_value_with_segments_and_mask": [
      "self",
      "loss_fn"
    ],
    "test_computes_loss_value_with_where": [
      "self",
      "loss_fn"
    ],
    "test_computes_loss_value_with_all_masked": [
      "self",
      "loss_fn"
    ],
    "test_computes_loss_with_arbitrary_batch_dimensions": [
      "self",
      "loss_fn"
    ],
    "test_grad_does_not_return_nan_for_zero_labels": [
      "self",
      "loss_fn"
    ],
    "test_grad_does_not_return_nan_with_all_masked": [
      "self",
      "loss_fn"
    ],
    "test_ignores_lists_containing_only_invalid_items": [
      "self",
      "loss_fn"
    ]
  },
  "project": [],
  "copyright": [],
  "author": [],
  "master_doc": [],
  "extensions": [],
  "templates_path": [],
  "exclude_patterns": [],
  "autodoc_default_options": [],
  "html_theme": [],
  "html_static_path": [],
  "doctest_test_doctest_blocks": [],
  "doctest_global_setup": [],
  "doctest_default_flags": [],
  "bibtex_bibfiles": [],
  "bibtex_default_style": [],
  "bibtex_reference_style": [],
  "katex_options": [],
  "intersphinx_mapping": [],
  "prepare_dataset": [
    "ds",
    "batch_size",
    "list_size",
    "shuffle_size",
    "rng_seed"
  ],
  "model_fn": [
    "w",
    "features"
  ],
  "train": [
    "ds",
    "approx_metric",
    "epochs",
    "lr",
    "seed"
  ],
  "eval_metrics": [
    "ds",
    "w",
    "metrics"
  ],
  "main": [
    "argv",
    "epochs"
  ],
  "letor_dataset": [
    "self"
  ],
  "ApproxMetricsTest": {
    "test_end_to_end": [
      "self"
    ]
  },
  "read_data": [
    "batch_size",
    "lists_per_batch"
  ],
  "DNN": {
    "__call__": [
      "self",
      "inputs"
    ]
  },
  "SegmentationTest": {
    "test_end_to_end": [
      "self"
    ]
  },
  "ModelState": [],
  "OptState": [],
  "Web30kTest": {
    "test_end_to_end": [
      "self"
    ]
  },
  "_msmarco_preprocessor": [
    "dataset",
    "output_features",
    "shuffle_lists"
  ],
  "_OUTPUT_FEATURES": [],
  "RankingEncDecFeatureConverterTest": {
    "test_end_to_end": [
      "self"
    ]
  },
  "RankingEncDecModelTest": {
    "test_get_initial_variables": [
      "self"
    ],
    "test_loss_fn": [
      "self"
    ]
  },
  "FeatureSpec": [],
  "PyTree": [],
  "DEFAULT_LOSS_FN": [],
  "DEFAULT_METRIC_FNS": [],
  "RankingEncDecFeatureConverter": {
    "TASK_FEATURES": [],
    "MODEL_FEATURES": [],
    "PACKING_FEATURE_DTYPES": [],
    "_convert_features": [
      "self",
      "ds",
      "task_feature_lengths"
    ],
    "get_model_feature_lengths": [
      "self",
      "task_feature_lengths"
    ]
  },
  "RankingEncDecModel": {
    "FEATURE_CONVERTER_CLS": [],
    "__init__": [
      "self",
      "module",
      "input_vocabulary",
      "output_vocabulary",
      "optimizer_def",
      "rax_loss_fn",
      "rax_metric_fns",
      "loss_normalizing_factor"
    ],
    "get_initial_variables": [
      "self",
      "rng",
      "input_shapes",
      "input_types"
    ],
    "_compute_logits": [
      "self",
      "params",
      "batch"
    ],
    "loss_fn": [
      "self",
      "params",
      "batch",
      "dropout_rng"
    ],
    "_compute_metrics": [
      "self",
      "loss",
      "scores",
      "labels",
      "mask"
    ]
  },
  "TasksTest": {
    "test_msmarco_preprocessor": [
      "self"
    ]
  }
}