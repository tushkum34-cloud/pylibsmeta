{
  "stripe_flash_attn_forward": [
    "process_group",
    "q",
    "k",
    "v",
    "softmax_scale",
    "dropout_p",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic"
  ],
  "stripe_flash_attn_backward": [
    "process_group",
    "dout",
    "q",
    "k",
    "v",
    "out",
    "softmax_lse",
    "softmax_scale",
    "dropout_p",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic"
  ],
  "StripeFlashAttnFunc": {
    "forward": [
      "ctx",
      "q",
      "k",
      "v",
      "dropout_p",
      "softmax_scale",
      "causal",
      "window_size",
      "alibi_slopes",
      "deterministic",
      "return_softmax",
      "group"
    ],
    "backward": [
      "ctx",
      "dout"
    ]
  },
  "stripe_flash_attn_qkvpacked_func": [
    "qkv",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "stripe_flash_attn_kvpacked_func": [
    "q",
    "kv",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "stripe_flash_attn_func": [
    "q",
    "k",
    "v",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "ring_flash_attn_varlen_forward": [
    "process_group",
    "q",
    "k",
    "v",
    "cu_seqlens",
    "max_seqlen",
    "softmax_scale",
    "dropout_p",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic"
  ],
  "ring_flash_attn_varlen_backward": [
    "process_group",
    "dout",
    "q",
    "k",
    "v",
    "out",
    "softmax_lse",
    "cu_seqlens",
    "max_seqlen",
    "softmax_scale",
    "dropout_p",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic"
  ],
  "RingFlashAttnVarlenFunc": {
    "forward": [
      "ctx",
      "q",
      "k",
      "v",
      "cu_seqlens",
      "max_seqlen",
      "dropout_p",
      "softmax_scale",
      "causal",
      "window_size",
      "alibi_slopes",
      "deterministic",
      "return_softmax",
      "group"
    ],
    "backward": [
      "ctx",
      "dout"
    ]
  },
  "ring_flash_attn_varlen_qkvpacked_func": [
    "qkv",
    "cu_seqlens",
    "max_seqlen",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "ring_flash_attn_varlen_kvpacked_func": [
    "q",
    "kv",
    "cu_seqlens",
    "max_seqlen",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "ring_flash_attn_varlen_func": [
    "q",
    "k",
    "v",
    "cu_seqlens",
    "max_seqlen",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "ring_flash_attn_forward": [
    "process_group",
    "q",
    "k",
    "v",
    "softmax_scale",
    "dropout_p",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic"
  ],
  "ring_flash_attn_backward": [
    "process_group",
    "dout",
    "q",
    "k",
    "v",
    "out",
    "softmax_lse",
    "softmax_scale",
    "dropout_p",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic"
  ],
  "RingFlashAttnFunc": {
    "forward": [
      "ctx",
      "q",
      "k",
      "v",
      "dropout_p",
      "softmax_scale",
      "causal",
      "window_size",
      "alibi_slopes",
      "deterministic",
      "return_softmax",
      "group"
    ],
    "backward": [
      "ctx",
      "dout"
    ]
  },
  "ring_flash_attn_qkvpacked_func": [
    "qkv",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "ring_flash_attn_kvpacked_func": [
    "q",
    "kv",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "ring_flash_attn_func": [
    "q",
    "k",
    "v",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "llama3_flash_attn_prepare_cu_seqlens": [
    "cu_seqlens",
    "causal",
    "rank",
    "world_size"
  ],
  "llama3_flash_attn_varlen_forward": [
    "process_group",
    "q",
    "k",
    "v",
    "cu_seqlens_q",
    "cu_seqlens_k",
    "max_seqlen_q",
    "max_seqlen_k",
    "heads_k_stride",
    "local_k_slice",
    "softmax_scale",
    "dropout_p",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic"
  ],
  "llama3_flash_attn_varlen_backward": [
    "process_group",
    "dout",
    "q",
    "k",
    "v",
    "out",
    "softmax_lse",
    "cu_seqlens_q",
    "cu_seqlens_k",
    "max_seqlen_q",
    "max_seqlen_k",
    "heads_k_stride",
    "local_k_slice",
    "softmax_scale",
    "dropout_p",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic"
  ],
  "Llama3FlashAttnVarlenFunc": {
    "forward": [
      "ctx",
      "q",
      "k",
      "v",
      "cu_seqlens_q",
      "cu_seqlens_k",
      "max_seqlen_q",
      "max_seqlen_k",
      "heads_k_stride",
      "local_k_slice",
      "dropout_p",
      "softmax_scale",
      "causal",
      "window_size",
      "alibi_slopes",
      "deterministic",
      "return_softmax",
      "group"
    ],
    "backward": [
      "ctx",
      "dout"
    ]
  },
  "llama3_flash_attn_varlen_qkvpacked_func": [
    "qkv",
    "cu_seqlens_q",
    "cu_seqlens_k",
    "max_seqlen_q",
    "max_seqlen_k",
    "heads_k_stride",
    "local_k_slice",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "llama3_flash_attn_varlen_kvpacked_func": [
    "q",
    "kv",
    "cu_seqlens_q",
    "cu_seqlens_k",
    "max_seqlen_q",
    "max_seqlen_k",
    "heads_k_stride",
    "local_k_slice",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "llama3_flash_attn_varlen_func": [
    "q",
    "k",
    "v",
    "cu_seqlens_q",
    "cu_seqlens_k",
    "max_seqlen_q",
    "max_seqlen_k",
    "heads_k_stride",
    "local_k_slice",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "__all__": [],
  "_get_default_args": [
    "func"
  ],
  "get_default_args": [
    "func"
  ],
  "_update_out_and_lse": [
    "out",
    "lse",
    "block_out",
    "block_lse"
  ],
  "update_out_and_lse": [
    "out",
    "lse",
    "block_out",
    "block_lse",
    "slice_"
  ],
  "flatten_varlen_lse": [
    "lse",
    "cu_seqlens"
  ],
  "unflatten_varlen_lse": [
    "lse",
    "cu_seqlens",
    "max_seqlen"
  ],
  "RingComm": {
    "__init__": [
      "self",
      "process_group"
    ],
    "send_recv": [
      "self",
      "to_send",
      "recv_tensor"
    ],
    "commit": [
      "self"
    ],
    "wait": [
      "self"
    ],
    "send_recv_kv": [
      "self",
      "k",
      "v",
      "k_buffer",
      "v_buffer"
    ]
  },
  "AllGatherComm": {
    "__init__": [
      "self",
      "group"
    ],
    "all_gather": [
      "self",
      "output_tensor",
      "input_tensor"
    ],
    "wait": [
      "self"
    ]
  },
  "zigzag_ring_flash_attn_forward": [
    "process_group",
    "q",
    "k",
    "v",
    "softmax_scale",
    "dropout_p",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic"
  ],
  "zigzag_ring_flash_attn_backward": [
    "process_group",
    "dout",
    "q",
    "k",
    "v",
    "out",
    "softmax_lse",
    "softmax_scale",
    "dropout_p",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic"
  ],
  "ZigZagRingFlashAttnFunc": {
    "forward": [
      "ctx",
      "q",
      "k",
      "v",
      "dropout_p",
      "softmax_scale",
      "causal",
      "window_size",
      "alibi_slopes",
      "deterministic",
      "return_softmax",
      "group"
    ],
    "backward": [
      "ctx",
      "dout"
    ]
  },
  "zigzag_ring_flash_attn_qkvpacked_func": [
    "qkv",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "zigzag_ring_flash_attn_kvpacked_func": [
    "q",
    "kv",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "zigzag_ring_flash_attn_func": [
    "q",
    "k",
    "v",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "get_half_index": [
    "cu_seqlens"
  ],
  "get_half_lse": [
    "lse",
    "cu_seqlens"
  ],
  "zigzag_ring_flash_attn_varlen_forward": [
    "process_group",
    "q",
    "k",
    "v",
    "cu_seqlens",
    "max_seqlen",
    "half_index0",
    "half_index1",
    "softmax_scale",
    "dropout_p",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic"
  ],
  "zigzag_ring_flash_attn_varlen_backward": [
    "process_group",
    "dout",
    "q",
    "k",
    "v",
    "out",
    "softmax_lse",
    "cu_seqlens",
    "max_seqlen",
    "half_index0",
    "half_index1",
    "softmax_scale",
    "dropout_p",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic"
  ],
  "ZigZagRingFlashAttnVarlenFunc": {
    "forward": [
      "ctx",
      "q",
      "k",
      "v",
      "cu_seqlens",
      "max_seqlen",
      "dropout_p",
      "softmax_scale",
      "causal",
      "window_size",
      "alibi_slopes",
      "deterministic",
      "return_softmax",
      "group"
    ],
    "backward": [
      "ctx",
      "dout"
    ]
  },
  "zigzag_ring_flash_attn_varlen_qkvpacked_func": [
    "qkv",
    "cu_seqlens",
    "max_seqlen",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "zigzag_ring_flash_attn_varlen_kvpacked_func": [
    "q",
    "kv",
    "cu_seqlens",
    "max_seqlen",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "zigzag_ring_flash_attn_varlen_func": [
    "q",
    "k",
    "v",
    "cu_seqlens",
    "max_seqlen",
    "dropout_p",
    "softmax_scale",
    "causal",
    "window_size",
    "alibi_slopes",
    "deterministic",
    "return_attn_probs",
    "group"
  ],
  "flatten_kernel": [
    "OUT",
    "LSE",
    "CU_SEQLENS",
    "stride_out_nheads",
    "stride_out_seqlen",
    "stride_lse_batch",
    "stride_lse_nheads",
    "stride_lse_seqlen",
    "BLOCK_M"
  ],
  "unflatten_kernel": [
    "OUT",
    "LSE",
    "CU_SEQLENS",
    "stride_out_batch",
    "stride_out_nheads",
    "stride_out_seqlen",
    "stride_lse_seqlen",
    "stride_lse_nheads",
    "BLOCK_M"
  ],
  "DATA_PARAMS": [],
  "RING_ATTN_SWITCH": [],
  "check_params": [
    "f1",
    "f2"
  ],
  "update_ring_flash_attn_params": [
    "cu_seqlens",
    "process_group"
  ],
  "use_ring_attn": [
    "flag"
  ],
  "create_ring_flash_attention_forward": [
    "process_group",
    "heads_k_stride"
  ],
  "_use_top_left_mask": [],
  "flash_attention_forward": [
    "module",
    "query",
    "key",
    "value",
    "attention_mask",
    "dropout",
    "scaling",
    "sliding_window",
    "softcap"
  ],
  "substitute_hf_flash_attn": [
    "process_group",
    "heads_k_stride"
  ]
}